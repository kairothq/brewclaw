---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on:
  - 01-01
files_modified:
  - src/app/layout.tsx
  - src/app/globals.css
  - src/lib/gsap-config.ts
  - src/components/providers/motion-provider.tsx
  - src/components/providers/gsap-provider.tsx
  - src/hooks/use-reduced-motion.ts
  - package.json
autonomous: true
requirements:
  - FOUND-02
  - FOUND-03
  - FOUND-04
  - FOUND-05

must_haves:
  truths:
    - "Typography renders with Space Grotesk for headings, Geist Sans for body, Geist Mono for code"
    - "CSS custom properties (design tokens) are accessible via Tailwind utilities"
    - "Motion animations respect system reduced-motion preference"
    - "GSAP ScrollTrigger is registered and ready for scroll animations"
    - "Animation providers wrap the app without hydration errors"
  artifacts:
    - path: "src/components/providers/motion-provider.tsx"
      provides: "MotionConfig wrapper with reducedMotion setting"
      contains: "MotionConfig"
      min_lines: 8
    - path: "src/components/providers/gsap-provider.tsx"
      provides: "GSAP initialization and cleanup"
      contains: "ScrollTrigger"
      min_lines: 15
    - path: "src/lib/gsap-config.ts"
      provides: "GSAP plugin registration"
      contains: "gsap.registerPlugin"
    - path: "src/hooks/use-reduced-motion.ts"
      provides: "Hook for detecting reduced motion preference"
      contains: "prefers-reduced-motion"
      min_lines: 15
    - path: "src/app/layout.tsx"
      provides: "Root layout with fonts and providers"
      contains: "MotionProvider"
      min_lines: 25
    - path: "src/app/globals.css"
      provides: "Complete design tokens and Tailwind theme"
      contains: "@theme inline"
      min_lines: 60
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/providers/motion-provider.tsx"
      via: "import and wrapper"
      pattern: "MotionProvider"
    - from: "src/app/layout.tsx"
      to: "src/components/providers/gsap-provider.tsx"
      via: "import and wrapper"
      pattern: "GSAPProvider"
    - from: "src/components/providers/gsap-provider.tsx"
      to: "src/lib/gsap-config.ts"
      via: "import"
      pattern: "from.*gsap-config"
    - from: "src/app/layout.tsx"
      to: "fonts"
      via: "next/font imports and CSS variables"
      pattern: "Space_Grotesk|GeistSans"
---

<objective>
Configure animation providers (Motion + GSAP), typography system (three fonts), design tokens (CSS variables), and reduced-motion accessibility support.

Purpose: Enable all animation and styling capabilities for subsequent UI development.
Output: Fully configured providers, fonts loading correctly, design tokens applied, reduced-motion respected.
</objective>

<execution_context>
@/Users/divykairoth/.claude/get-shit-done/workflows/execute-plan.md
@/Users/divykairoth/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install animation dependencies and create providers</name>
  <files>
    package.json
    src/lib/gsap-config.ts
    src/components/providers/motion-provider.tsx
    src/components/providers/gsap-provider.tsx
  </files>
  <action>
    Install animation dependencies:
    ```bash
    npm install motion gsap @gsap/react
    ```

    Create GSAP configuration (src/lib/gsap-config.ts):
    ```typescript
    "use client"

    import gsap from 'gsap'
    import { ScrollTrigger } from 'gsap/ScrollTrigger'
    import { useGSAP } from '@gsap/react'

    // Register plugins once - check for window to prevent SSR issues
    if (typeof window !== 'undefined') {
      gsap.registerPlugin(ScrollTrigger, useGSAP)
    }

    export { gsap, ScrollTrigger, useGSAP }
    ```

    Create Motion provider (src/components/providers/motion-provider.tsx):
    ```typescript
    "use client"

    import { MotionConfig } from 'motion/react'

    export function MotionProvider({ children }: { children: React.ReactNode }) {
      return (
        <MotionConfig reducedMotion="user">
          {children}
        </MotionConfig>
      )
    }
    ```

    Create GSAP provider (src/components/providers/gsap-provider.tsx):
    ```typescript
    "use client"

    import { useEffect } from 'react'
    import { ScrollTrigger } from '@/lib/gsap-config'

    export function GSAPProvider({ children }: { children: React.ReactNode }) {
      useEffect(() => {
        // Configure ScrollTrigger defaults
        ScrollTrigger.defaults({
          toggleActions: 'play none none reverse',
        })

        // Cleanup all ScrollTriggers on unmount
        return () => {
          ScrollTrigger.getAll().forEach(trigger => trigger.kill())
        }
      }, [])

      return <>{children}</>
    }
    ```

    Create directories if they don't exist:
    - src/components/providers/
    - src/lib/ (should exist from shadcn)

    Per user decision: Motion handles component animations (entrances, hovers, layout). GSAP handles scroll-triggered animations. Never apply both to the same DOM element.
  </action>
  <verify>
    - npm install completes without errors
    - All three files created with "use client" directive
    - No TypeScript errors when running `npm run dev`
    - Check src/lib/gsap-config.ts exports gsap, ScrollTrigger, useGSAP
  </verify>
  <done>
    Animation dependencies installed. Motion provider with reducedMotion="user". GSAP provider with ScrollTrigger registered and cleanup. Both are client components.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure typography and design tokens</name>
  <files>
    package.json
    src/app/layout.tsx
    src/app/globals.css
  </files>
  <action>
    Install Geist font package:
    ```bash
    npm install geist
    ```

    Update src/app/layout.tsx with fonts and providers:
    ```typescript
    import type { Metadata } from 'next'
    import { Space_Grotesk } from 'next/font/google'
    import { GeistSans, GeistMono } from 'geist/font/next'
    import { MotionProvider } from '@/components/providers/motion-provider'
    import { GSAPProvider } from '@/components/providers/gsap-provider'
    import './globals.css'

    const spaceGrotesk = Space_Grotesk({
      subsets: ['latin'],
      variable: '--font-space-grotesk',
      display: 'swap',
    })

    export const metadata: Metadata = {
      title: 'BrewClaw - Your Personal AI Assistant',
      description: 'Deploy your personal AI assistant in under 5 minutes. No code needed.',
    }

    export default function RootLayout({
      children,
    }: {
      children: React.ReactNode
    }) {
      return (
        <html
          lang="en"
          className={`${spaceGrotesk.variable} ${GeistSans.variable} ${GeistMono.variable}`}
        >
          <body className="font-sans antialiased bg-background text-foreground">
            <MotionProvider>
              <GSAPProvider>
                {children}
              </GSAPProvider>
            </MotionProvider>
          </body>
        </html>
      )
    }
    ```

    Replace src/app/globals.css with complete design tokens (from PRD and RESEARCH.md):
    ```css
    @import "tailwindcss";
    @import "tw-animate-css";

    @custom-variant dark (&:is(.dark *));

    /* Design tokens from PRD Design System */
    :root {
      /* Base grayscale */
      --color-black: #000000;
      --color-near-black: #0A0A0A;
      --color-card-bg: #111111;
      --color-input-bg: #1A1A1A;
      --color-border: #222222;
      --color-border-subtle: #333333;
      --color-muted: #666666;
      --color-secondary: #999999;
      --color-white: #FFFFFF;

      /* Coffee accents (use sparingly - <5% of page) */
      --color-dark-roast: #451A03;
      --color-espresso: #78350F;
      --color-medium-roast: #92400E;
      --color-caramel: #B45309;
      --color-amber: #D97706;

      /* Semantic colors for shadcn/ui (OKLCH format) */
      --background: oklch(0.09 0 0);
      --foreground: oklch(1 0 0);
      --card: oklch(0.12 0 0);
      --card-foreground: oklch(1 0 0);
      --popover: oklch(0.12 0 0);
      --popover-foreground: oklch(1 0 0);
      --primary: oklch(1 0 0);
      --primary-foreground: oklch(0.09 0 0);
      --secondary: oklch(0.18 0 0);
      --secondary-foreground: oklch(1 0 0);
      --muted: oklch(0.18 0 0);
      --muted-foreground: oklch(0.55 0 0);
      --accent: oklch(0.5 0.15 50);
      --accent-foreground: oklch(1 0 0);
      --destructive: oklch(0.577 0.245 27.325);
      --destructive-foreground: oklch(1 0 0);
      --border: oklch(0.18 0 0);
      --input: oklch(0.18 0 0);
      --ring: oklch(0.4 0 0);

      /* Spacing */
      --radius: 0.75rem;
    }

    @theme inline {
      /* Typography */
      --font-sans: var(--font-geist-sans), system-ui, sans-serif;
      --font-mono: var(--font-geist-mono), monospace;
      --font-heading: var(--font-space-grotesk), system-ui, sans-serif;

      /* Colors mapped to Tailwind */
      --color-background: var(--background);
      --color-foreground: var(--foreground);
      --color-card: var(--card);
      --color-card-foreground: var(--card-foreground);
      --color-popover: var(--popover);
      --color-popover-foreground: var(--popover-foreground);
      --color-primary: var(--primary);
      --color-primary-foreground: var(--primary-foreground);
      --color-secondary: var(--secondary);
      --color-secondary-foreground: var(--secondary-foreground);
      --color-muted: var(--muted);
      --color-muted-foreground: var(--muted-foreground);
      --color-accent: var(--accent);
      --color-accent-foreground: var(--accent-foreground);
      --color-destructive: var(--destructive);
      --color-destructive-foreground: var(--destructive-foreground);
      --color-border: var(--border);
      --color-input: var(--input);
      --color-ring: var(--ring);

      /* Coffee accent colors */
      --color-espresso: var(--color-espresso);
      --color-dark-roast: var(--color-dark-roast);
      --color-caramel: var(--color-caramel);

      /* Radius */
      --radius-sm: calc(var(--radius) - 4px);
      --radius-md: calc(var(--radius) - 2px);
      --radius-lg: var(--radius);
      --radius-xl: calc(var(--radius) + 4px);
    }

    @layer base {
      * {
        @apply border-border outline-ring/50;
      }
      body {
        @apply bg-background text-foreground;
      }
    }

    /* Animation keyframes */
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    @keyframes pulse-glow {
      0%, 100% { opacity: 1; box-shadow: 0 0 4px currentColor; }
      50% { opacity: 0.6; box-shadow: 0 0 8px currentColor; }
    }
    ```

    Install tw-animate-css if not already installed:
    ```bash
    npm install tw-animate-css
    ```

    Per user decision: Colors follow PRD palette (#0A0A0A dark, #FFFFFF light, #78350F espresso accent).
  </action>
  <verify>
    - Run `npm run dev` - no build errors
    - Visit localhost:3000 - verify dark background (#0A0A0A equivalent)
    - Inspect text - verify font-family includes Geist Sans
    - Inspect heading - verify font-family includes Space Grotesk
    - Check browser DevTools Computed styles for CSS variables
  </verify>
  <done>
    Typography configured with three fonts (Space Grotesk, Geist Sans, Geist Mono). Design tokens defined as CSS variables. Providers wrap the app. Dark theme applied.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add reduced-motion support</name>
  <files>
    src/hooks/use-reduced-motion.ts
    src/app/page.tsx
  </files>
  <action>
    Create reduced-motion hook (src/hooks/use-reduced-motion.ts):
    ```typescript
    "use client"

    import { useEffect, useState } from 'react'

    export function useReducedMotion(): boolean {
      const [prefersReducedMotion, setPrefersReducedMotion] = useState(false)

      useEffect(() => {
        // Check if running in browser
        if (typeof window === 'undefined') return

        const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)')
        setPrefersReducedMotion(mediaQuery.matches)

        const handler = (event: MediaQueryListEvent) => {
          setPrefersReducedMotion(event.matches)
        }

        mediaQuery.addEventListener('change', handler)
        return () => mediaQuery.removeEventListener('change', handler)
      }, [])

      return prefersReducedMotion
    }
    ```

    Create hooks directory if it doesn't exist: src/hooks/

    Update src/app/page.tsx to demonstrate all foundation elements:
    ```typescript
    import { Button } from "@/components/ui/button"

    export default function Home() {
      return (
        <main className="flex min-h-screen flex-col items-center justify-center p-24 gap-8">
          {/* Heading with Space Grotesk */}
          <h1 className="text-5xl font-heading font-bold">BrewClaw</h1>

          {/* Body text with Geist Sans */}
          <p className="text-lg text-muted-foreground max-w-md text-center">
            Deploy your personal AI assistant in under 5 minutes.
            No code needed.
          </p>

          {/* Code sample with Geist Mono */}
          <code className="font-mono text-sm bg-card px-4 py-2 rounded-lg border border-border">
            npx brewclaw init
          </code>

          {/* Button with accent styling */}
          <Button className="bg-accent text-accent-foreground hover:bg-accent/90">
            Get Started
          </Button>

          {/* Trust line */}
          <span className="text-sm text-muted-foreground">
            $2 credits included - No code needed
          </span>
        </main>
      )
    }
    ```

    Per user decision: Reduced motion is Claude's discretion for strictness level. Implementing reasonable defaults: Motion handles via MotionConfig, GSAP checks via hook.
  </action>
  <verify>
    - src/hooks/use-reduced-motion.ts exists with proper hook logic
    - npm run dev shows no errors
    - Page displays all three font families correctly:
      - "BrewClaw" heading in Space Grotesk (check computed font-family)
      - Body text in Geist Sans
      - Code block in Geist Mono
    - Test reduced motion (macOS: System Preferences > Accessibility > Display > Reduce motion)
  </verify>
  <done>
    useReducedMotion hook created for GSAP animations. Demo page shows all typography working. Motion provider automatically respects preference. Foundation complete.
  </done>
</task>

</tasks>

<verification>
After all tasks complete, verify the full foundation:

1. **Dev server:** `npm run dev` runs without errors
2. **Typography:**
   - Heading "BrewClaw" uses Space Grotesk (inspect element)
   - Body text uses Geist Sans
   - Code uses Geist Mono
3. **Design tokens:**
   - Background is dark (#0A0A0A equivalent)
   - Text is white
   - Button shows accent color
   - Border colors apply correctly
4. **Providers:**
   - No hydration errors in console
   - React DevTools shows MotionProvider and GSAPProvider in tree
5. **Reduced motion:**
   - Enable "Reduce motion" in OS settings
   - Motion animations should be disabled
</verification>

<success_criteria>
- All three fonts render correctly (Space Grotesk, Geist Sans, Geist Mono)
- CSS variables accessible via Tailwind utilities (bg-background, text-foreground, etc.)
- MotionProvider wraps app with reducedMotion="user"
- GSAPProvider initializes ScrollTrigger with cleanup
- useReducedMotion hook available for GSAP components
- No hydration errors or console warnings
- Demo page shows all foundation elements working
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`
</output>
